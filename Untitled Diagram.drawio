<mxfile host="app.diagrams.net" modified="2021-12-01T01:57:19.820Z" agent="5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.45 Safari/537.36" etag="T4uN-hKxKQLoK4W1GSQj" version="15.8.7" type="github">
  <diagram id="C5RBs43oDa-KdzZeNtuy" name="Page-1">
    <mxGraphModel dx="974" dy="542" grid="1" gridSize="13" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="3300" pageHeight="4681" math="0" shadow="0">
      <root>
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-0" />
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-1" parent="WIyWlLk6GJQsqaUBKTNV-0" />
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-2" value="" style="rounded=0;html=1;jettySize=auto;orthogonalLoop=1;fontSize=11;endArrow=block;endFill=0;endSize=8;strokeWidth=1;shadow=0;labelBackgroundColor=none;edgeStyle=orthogonalEdgeStyle;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="WIyWlLk6GJQsqaUBKTNV-3" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1467" y="152" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-3" value="intercept_hook_point =&amp;nbsp;hook_wrapper()" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;glass=0;strokeWidth=1;shadow=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1347" y="52" width="240" height="40" as="geometry" />
        </mxCell>
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-4" value="Yes" style="rounded=0;html=1;jettySize=auto;orthogonalLoop=1;fontSize=11;endArrow=block;endFill=0;endSize=8;strokeWidth=1;shadow=0;labelBackgroundColor=none;edgeStyle=orthogonalEdgeStyle;" parent="WIyWlLk6GJQsqaUBKTNV-1" edge="1">
          <mxGeometry y="20" relative="1" as="geometry">
            <mxPoint as="offset" />
            <mxPoint x="1467" y="182" as="sourcePoint" />
            <mxPoint x="1467" y="272" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="S21cvZebMdiASYtHkf3q-0">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1467" y="392" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-0" value="syscall_desc = get_syscall_desc()" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1337" y="242" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="S21cvZebMdiASYtHkf3q-2" target="S21cvZebMdiASYtHkf3q-4">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1467" y="482" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-2" value="myf_sys_open()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1407" y="392" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="S21cvZebMdiASYtHkf3q-4">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1467" y="512" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-4" value="fp = myf_file_alloc()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1407" y="452" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-6" value="hook()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1407" y="152" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=1 2;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="S21cvZebMdiASYtHkf3q-7">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1587" y="527" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=1 2;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="S21cvZebMdiASYtHkf3q-7">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1467" y="585" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1467" y="585" />
              <mxPoint x="1467" y="585" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-7" value="myf_shadow_open" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1407" y="512" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-9" value="&lt;h1&gt;myf_shadow_xx&lt;/h1&gt;&lt;div&gt;这些文件和函数都是用到了fshadow里面的API接口。所以在命名的时候，用myf_fshadow来表示。&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1587" y="467" width="190" height="120" as="geometry" />
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-10" value="" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.annotation_2;align=left;labelPosition=right;pointerEvents=1;dashed=1;dashPattern=1 1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1287" y="62" width="78" height="315" as="geometry" />
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-12" value="&lt;h1&gt;syscall&lt;/h1&gt;&lt;p&gt;这部分接口主要是给syscall用的。也就是hook了OS的syscall，然后这里主要在进行分发&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;dashed=1;dashPattern=1 1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1118" y="152" width="190" height="120" as="geometry" />
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-16" value="myf_fshadow_devopen" style="whiteSpace=wrap;html=1;align=center;verticalAlign=middle;treeFolding=1;treeMoving=1;dashed=1;dashPattern=1 1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1209" y="715" width="138" height="60" as="geometry" />
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-35" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="S21cvZebMdiASYtHkf3q-17">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1467" y="832" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-17" value="myf_fshadow_fileopen" style="whiteSpace=wrap;html=1;align=center;verticalAlign=middle;treeFolding=1;treeMoving=1;dashed=1;dashPattern=1 1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1399" y="715" width="136" height="60" as="geometry" />
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-18" value="myf_fshadow_diropen" style="whiteSpace=wrap;html=1;align=center;verticalAlign=middle;treeFolding=1;treeMoving=1;dashed=1;dashPattern=1 1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1586" y="715" width="146" height="60" as="geometry" />
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-28" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="S21cvZebMdiASYtHkf3q-25" target="S21cvZebMdiASYtHkf3q-17">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-34" value="file" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="S21cvZebMdiASYtHkf3q-28">
          <mxGeometry x="-0.2071" y="3" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-30" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="S21cvZebMdiASYtHkf3q-25" target="S21cvZebMdiASYtHkf3q-18">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-33" value="dir" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="S21cvZebMdiASYtHkf3q-30">
          <mxGeometry x="-0.2354" y="3" relative="1" as="geometry">
            <mxPoint y="1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-31" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="S21cvZebMdiASYtHkf3q-25" target="S21cvZebMdiASYtHkf3q-16">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-32" value="dev" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="S21cvZebMdiASYtHkf3q-31">
          <mxGeometry x="0.0346" y="-1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-25" value="dev/dir/file?" style="rhombus;whiteSpace=wrap;html=1;dashed=1;dashPattern=1 1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1427" y="587" width="80" height="63" as="geometry" />
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-37" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="S21cvZebMdiASYtHkf3q-36" target="S21cvZebMdiASYtHkf3q-38">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1464" y="897" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-36" value="重头设置omode" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;dashPattern=1 1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1410" y="832" width="114" height="26" as="geometry" />
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-41" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=1 2;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="S21cvZebMdiASYtHkf3q-38">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1313" y="916.5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-43" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=1 2;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="S21cvZebMdiASYtHkf3q-38" target="S21cvZebMdiASYtHkf3q-44">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1467" y="975" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-38" value="my_fshadow_open_full_path" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;dashPattern=1 1;fillColor=#d80073;strokeColor=#A50040;fontColor=#ffffff;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1370.25" y="897" width="193.5" height="39" as="geometry" />
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-39" value="" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.annotation_2;align=left;labelPosition=right;pointerEvents=1;dashed=1;dashPattern=1 1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1027" y="416" width="377" height="429" as="geometry" />
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-40" value="&lt;h1&gt;file&lt;/h1&gt;&lt;div&gt;file部分可以认为是实现了一个虚基类。&lt;/div&gt;&lt;div&gt;class file {&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;int64_t offset;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;virtual file_ops() = 0;&lt;br&gt;};&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;dashed=1;dashPattern=1 1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1019" y="587" width="190" height="141" as="geometry" />
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-42" value="&lt;h1&gt;设置打开结果&lt;/h1&gt;&lt;p&gt;打开之后，需要设置fp即myf_file结构体的f_priv和f_ops。可以认为是子类对基类的实现。&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;dashed=1;dashPattern=1 1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1196" y="871" width="169" height="117" as="geometry" />
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-45" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=1 2;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="S21cvZebMdiASYtHkf3q-44" target="S21cvZebMdiASYtHkf3q-46">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1467" y="1040" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-44" value="去掉一些不用的Omode" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;dashPattern=1 1;fillColor=#ffcccc;strokeColor=#36393d;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1410" y="975" width="114" height="26" as="geometry" />
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-46" value="my_fshadow_open1()" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;dashPattern=1 1;fillColor=#ffcccc;strokeColor=#36393d;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1403.5" y="1040" width="127" height="26" as="geometry" />
        </mxCell>
        <mxCell id="S21cvZebMdiASYtHkf3q-49" value="函数的返回值是fshadow私有的file结构&amp;nbsp;" style="ellipse;shape=cloud;whiteSpace=wrap;html=1;align=center;dashed=1;dashPattern=1 4;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1563.75" y="872.25" width="156" height="88.5" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
